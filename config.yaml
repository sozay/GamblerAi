# GamblerAI Configuration

database:
  timeseries:
    host: ${TIMESCALE_HOST:localhost}
    port: ${TIMESCALE_PORT:5432}
    name: gambler_timeseries
    user: ${DB_USER:gambler}
    password: ${DB_PASSWORD:gambler_pass}

  analytics:
    host: ${POSTGRES_HOST:localhost}
    port: ${POSTGRES_PORT:5433}
    name: gambler_analytics
    user: ${DB_USER:gambler}
    password: ${DB_PASSWORD:gambler_pass}

redis:
  host: ${REDIS_HOST:localhost}
  port: ${REDIS_PORT:6379}
  db: 0
  ttl: 3600  # Cache TTL in seconds

data_sources:
  yahoo_finance:
    enabled: true
    rate_limit: 2000  # requests per hour

  alpha_vantage:
    enabled: false
    api_key: ${ALPHA_VANTAGE_KEY:}
    rate_limit: 500  # requests per day

  alpaca:
    enabled: true
    paper_trading: true
    api_key: ${ALPACA_API_KEY:PKJUPGKDCCIMZKPDXUFXHM3E4D}
    api_secret: ${ALPACA_API_SECRET:}  # Required - get from alpaca.markets dashboard
    base_url: https://paper-api.alpaca.markets
    data_url: https://data.alpaca.markets

analysis:
  # Momentum detection parameters
  momentum_detection:
    min_price_change_pct: 2.0      # Minimum % change to consider momentum
    min_volume_ratio: 2.0           # Volume vs 20-period average
    window_minutes: 5               # Time window for initial detection
    lookback_periods: 20            # For volume average calculation

  # Timeframes to analyze
  timeframes:
    - 1min
    - 5min
    - 15min
    - 1hour

  # Pattern analysis
  pattern_analysis:
    continuation_thresholds:       # Define continuation vs reversal
      strong: 0.70                 # >70% of initial move continues
      moderate: 0.40               # 40-70% continuation
      weak: 0.10                   # <40% continuation

    max_continuation_minutes: 60   # Max time to track continuation
    reversal_threshold_pct: 0.5    # % retracement to consider reversal

  # Statistical analysis
  statistics:
    min_samples: 100               # Minimum samples for significance
    confidence_level: 0.95         # 95% confidence intervals
    rolling_window_days: 90        # Period for rolling statistics

# Backtesting parameters
backtest:
  entry_threshold_probability: 0.6  # Min continuation probability to enter trade
  stop_loss_percentage: 2.0         # Stop loss % from entry
  take_profit_percentage: 4.0       # Take profit % from entry
  position_size: 10000              # Position size in dollars
  max_holding_minutes: 120          # Maximum trade duration in minutes

  # Execution slippage simulation
  execution_slippage:
    enabled: true                   # Enable/disable slippage simulation
    probability: 0.3                # % of time order executes at next bar (0.3 = 30%)
    delay_bars: 1                   # How many bars to delay execution (1 = next bar)

  # Configurable profit/loss targets (can be overridden per trade)
  profit_loss_targets:
    use_percentage_targets: true    # Use % targets instead of fixed prices
    stop_loss_pct: 1.0              # Stop loss % (e.g., 1.0 = 1% loss)
    take_profit_pct: 2.0            # Take profit % (e.g., 2.0 = 2% gain)
    trailing_stop:
      enabled: false                # Enable trailing stop
      activation_pct: 1.0           # Activate after 1% profit
      trail_pct: 0.5                # Trail by 0.5%

# Stock universe
stocks:
  # Initial list of stocks to analyze
  watchlist:
    - AAPL
    - MSFT
    - GOOGL
    - AMZN
    - TSLA
    - NVDA
    - META
    - AMD
    - NFLX
    - SPY  # S&P 500 ETF

  # Filters for stock selection
  filters:
    min_avg_volume: 1000000        # Minimum average daily volume
    min_price: 10                  # Minimum stock price
    max_price: 1000                # Maximum stock price

api:
  host: ${API_HOST:0.0.0.0}
  port: ${API_PORT:9090}
  cors_origins:
    - http://localhost:3000
    - http://localhost:8501
    - http://localhost:9090

  rate_limiting:
    enabled: true
    requests_per_minute: 60

celery:
  broker_url: ${CELERY_BROKER_URL:redis://localhost:6379/0}
  result_backend: ${CELERY_RESULT_BACKEND:redis://localhost:6379/0}
  task_serializer: json
  result_serializer: json
  timezone: UTC

logging:
  level: ${LOG_LEVEL:INFO}
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: logs/gambler_ai.log

dashboard:
  title: "GamblerAI - Momentum Analysis Dashboard"
  refresh_interval: 30  # seconds
  max_events_display: 100

# ============================================================
# MULTI-INSTANCE TRADING CONFIGURATION
# ============================================================

# Strategy Configurations
trading_strategies:
  mean-reversion-rs:
    name: "Mean Reversion + Relative Strength"
    primary_detector: MeanReversionDetector
    scanner_type: relative_strength
    parameters:
      bb_period: 20
      bb_std: 2.5
      rsi_oversold: 30
      rsi_overbought: 70
      volume_multiplier: 3.0
      relative_strength_period: 20
      use_relative_strength: true
      profit_target_pct: 2.0  # Fixed 2% profit target for 1:2 risk/reward
    position_size: 1000
    stop_loss_pct: 1.0
    target_bb_middle: false  # Using fixed profit target instead
    max_holding_minutes: 30

  gap-mean-reversion:
    name: "Gap Scanner + Mean Reversion"
    primary_detector: MeanReversionDetector
    scanner_type: gap_scanner
    parameters:
      bb_period: 20
      bb_std: 2.0  # Tighter for gap plays
      rsi_oversold: 35  # Less oversold for gap reversions
      volume_multiplier: 2.5
      min_gap_pct: 0.5  # Minimum gap size
      profit_target_pct: 2.4  # 2.4% target for 1:2 R/R with 1.2% stop
    position_size: 1000
    stop_loss_pct: 1.2  # Wider stop for gaps
    target_bb_middle: false  # Using fixed profit target instead
    max_holding_minutes: 45

  best-setup-mean-reversion:
    name: "Best Setup + Mean Reversion"
    primary_detector: MeanReversionDetector
    scanner_type: best_setups
    parameters:
      bb_period: 20
      bb_std: 2.5
      rsi_oversold: 30
      volume_multiplier: 3.0
      min_risk_reward: 2.0  # Only best R/R setups
      profit_target_pct: 2.0  # Fixed 2% profit target for 1:2 risk/reward
    position_size: 1000
    stop_loss_pct: 1.0
    target_bb_middle: false  # Using fixed profit target instead
    max_holding_minutes: 30

  rs-volatility-breakout:
    name: "Relative Strength + Volatility Breakout"
    primary_detector: VolatilityBreakoutDetector
    scanner_type: relative_strength
    parameters:
      atr_period: 14
      atr_compression_ratio: 0.5
      consolidation_min_bars: 20
      breakout_threshold: 0.5  # % breakout required
      relative_strength_period: 20
    position_size: 1000
    stop_loss_pct: 1.5
    max_holding_minutes: 60  # Longer hold for breakouts

  best-setup-volatility:
    name: "Best Setup + Volatility Breakout"
    primary_detector: VolatilityBreakoutDetector
    scanner_type: best_setups
    parameters:
      atr_period: 14
      atr_compression_ratio: 0.5
      consolidation_min_bars: 20
      breakout_threshold: 0.5
      min_risk_reward: 2.5  # Higher R/R for breakouts
    position_size: 1000
    stop_loss_pct: 1.5
    max_holding_minutes: 60

# Trading Instance Configurations
trading_instances:
  1:
    name: "Mean Reversion + Relative Strength"
    strategy: mean-reversion-rs
    symbols: [AAPL, MSFT, GOOGL, AMZN, TSLA, NVDA, META, AMD]
    interval_seconds: 60
    allocated_capital: 50000
    max_positions: 8
    description: "Bull market mean reversion on relative strength leaders"

  2:
    name: "Gap Scanner + Mean Reversion"
    strategy: gap-mean-reversion
    symbols: [SPY, QQQ, IWM, NFLX, ABNB, PYPL, SQ, COIN]
    interval_seconds: 45
    allocated_capital: 45000
    max_positions: 6
    description: "Gap fill plays with mean reversion confirmation"

  3:
    name: "Best Setup + Mean Reversion"
    strategy: best-setup-mean-reversion
    symbols: [ADBE, CSCO, INTC, QCOM, AVGO, TXN, MU, AMAT]
    interval_seconds: 60
    allocated_capital: 50000
    max_positions: 8
    description: "High R/R mean reversion setups only"

  4:
    name: "Relative Strength + Volatility Breakout"
    strategy: rs-volatility-breakout
    symbols: [ASML, GILD, PEP, CMCSA, ORCL, CRM, NOW, SHOP]
    interval_seconds: 45
    allocated_capital: 48000
    max_positions: 6
    description: "Breakouts from consolidation on market leaders"

  5:
    name: "Best Setup + Volatility Breakout"
    strategy: best-setup-volatility
    symbols: [SBUX, COST, PG, KO, NKE, DIS, UNH, JNJ]
    interval_seconds: 60
    allocated_capital: 50000
    max_positions: 6
    description: "Best volatility breakout setups with optimal R/R"

# Portfolio-Wide Risk Management
portfolio_risk_management:
  max_total_positions: 40
  max_daily_loss_pct: 10.0
  max_instance_daily_loss_pct: 5.0
  min_available_cash_pct: 20.0
  circuit_breaker:
    enable: true
    consecutive_losses: 10
    auto_resume_next_day: true

# Multi-Instance Monitoring
multi_instance_monitoring:
  enable_comparison: true
  comparison_metrics:
    - win_rate
    - avg_pnl
    - sharpe_ratio
    - max_drawdown
  enable_alerts: true
  alert_on_daily_loss: true
  alert_on_circuit_breaker: true
